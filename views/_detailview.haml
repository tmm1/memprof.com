%table.info
  - exclude = %w[ code node_code super_name class_name name ivars methods variables hasSubclasses ]
  - obj.each do |key,val|
    - next if key == 'line' and val == 0
    - next if key == 'super' and val == false
    - unless exclude.include?(key) or (!%w[ string float ].include?(obj['type']) and key == 'data')
      %tr
        %td.key= key == '_id' ? 'address' : key
        %td.addr= show_addr val
        - if %w[ file type line ].include?(key) and val
          %td.val
            - w = {key => val}
            - w['file'] = obj['file'] if key == 'line'
            %a{:href => "/panel?subview=detail&where=#{Yajl.dump w}"}
              - if key == 'file'
                = val.split('/').last(4).join('/')
              - else
                = val
        - else
          %td.val= show_val val

  - if metaclass = $dump.db.find_one('ivars.__attached__' => obj['_id']) and metaclass['_id'] != obj['class']
    %tr
      %td.key metaclass
      %td.addr= show_addr metaclass['_id']
      %td.val= show_val metaclass

  - if obj['type'] == 'class'
    - ancestors = $dump.ancestors_of(obj) and ancestors.any?
    - num = ancestors.size
    %tr
      %td.key ancestors
      %td.addr &nbsp;
      %td.val
        - ancestors.each_with_index do |a, i|
          %a{:href => "/panel?subview=detail&where=#{Yajl.dump :super => a['_id']}"}= show_val a['_id']
          %br/

    - instances = $dump.db.find(:class => obj['_id']).count
    %tr
      %td.key instances
      %td.addr &nbsp;
      %td.val
        %a{:href => "/panel?subview=detail&where=#{Yajl.dump :class => obj['_id']}"}= instances

    - subclasses = $dump.db.find(:super => obj['_id']).count
    %tr
      %td.key subclasses
      %td.addr &nbsp;
      %td.val
        %a{:href => "/panel?subview=detail&where=#{Yajl.dump :super => obj['_id']}"}= subclasses

- if obj['type'] == 'scope' and list = obj['variables'] and list.any?
  %table.info.variables
    - list.each do |key,val|
      %tr
        %td.key= show_val key
        %td.addr.left= show_addr key
        %td.addr.right= show_addr val
        %td.val= show_val val

- if obj['type'] == 'hash' and list = obj['data'] and list.any?
  %table.info.hash_data
    - list.sort_by{|k,v| k}.first(50).each do |key,val|
      %tr
        %td.key= show_val key
        %td.addr.left= show_addr key
        %td.addr.right= show_addr val
        %td.val= show_val val

- if obj['type'] == 'array' and list = obj['data'] and list.any?
  %table.info.array_data
    - list.each_with_index do |val,key|
      %tr
        %td.key= key
        %td.addr= show_addr val
        %td.val= show_val val

- if list = obj['ivars']
  - ivars, rest = list.partition{ |k,v| k =~ /^@\w/ }
  - cvars, rest = rest.partition{ |k,v| k =~ /^@/ }
  - internal, constants = rest.partition{ |k,v| k =~ /^__/ }

  - if internal.any?
    %table.info.internal
      - internal.sort_by{|k,v| k}.each do |key,val|
        %tr
          %td.key= key
          %td.addr= show_addr val
          %td.val= show_val val

  - if ivars.any?
    %table.info.ivars
      - ivars.sort_by{|k,v| k}.each do |key,val|
        %tr
          %td.key= key
          %td.addr= show_addr val
          %td.val= show_val val

  - if cvars.any?
    %table.info.cvars
      - cvars.sort_by{|k,v| k}.each do |key,val|
        %tr
          %td.key= key
          %td.addr= show_addr val
          %td.val= show_val val

  - if constants.any?
    %table.info.constants
      - constants.sort_by{|k,v| k}.each do |key,val|
        %tr
          %td.key= key
          %td.addr= show_addr val
          %td.val= show_val val

- if list = obj['methods']
  %table.info.methods
    - list.sort_by{|k,v| k}.each do |key,val|
      %tr
        %td.key= key
        %td.addr= show_addr val
        %td.val= show_val val
